/**
 * @name ItkCampaignBundle
 * @version v1.0.0
 * @link https://github.com/itk-os2display/campaign-bundle
 */
angular.module("itkCampaignApp").config(["$routeProvider","$translateProvider",function(e,n){"use strict";var a="bundles/itkcampaign/apps/itkCampaignApp/";n.useSanitizeValueStrategy("escape").useStaticFilesLoader({prefix:a+"translations/locale-",suffix:".json"}).preferredLanguage("da").fallbackLanguage("da").forceAsyncReload(!0),e.when("/campaign",{controller:"ItkCampaignOverviewController",templateUrl:a+"campaign-overview/campaign-overview.html?"+window.config.version}).when("/campaign/create",{controller:"ItkCampaignController",templateUrl:a+"campaign/campaign.html?"+window.config.version}).when("/campaign/{id}",{controller:"ItkCampaignController",templateUrl:a+"campaign/campaign.html?"+window.config.version})}]),angular.module("itkCampaignApp").service("itkCampaignAppSetup",["busService","userService","$translate",function(e,n,a){"use strict";e.$on("menuApp.requestMainMenuItems",function(i,t){n.hasRole("ROLE_ADMIN")&&e.$emit("menuApp.returnMainMenuItems",[{title:a.instant("menu.campaign"),route:"/#/campaign",activeFilter:"/campaign",icon:"picture_in_picture",weight:6}])}),e.$on("menuApp.requestSubMenuItems",function(i,t){var r=[];n.hasRole("ROLE_ADMIN")&&r.push({title:a.instant("menu.campaign_create"),path:"#/campaign/create",activeFilter:"/campaign/create",group:"left",weight:1}),e.$emit("menuApp.returnSubMenuItems",[{mainMenuItem:"campaign",items:r}])})}]),angular.module("itkCampaignApp").run(["itkCampaignAppSetup",angular.noop]),angular.module("itkCampaignApp").directive("contenteditable",function(){return{restrict:"A",require:"ngModel",link:function(e,n,a,i){function t(){i.$setViewValue(n.html())}i.$render=function(){n.html(i.$viewValue||"")},n.bind("blur keyup change",function(){e.$apply(t)})}}}),angular.module("itkCampaignApp").controller("ItkCampaignOverviewController",["busService","$scope","$timeout","ModalService","$routeParams","$location","$controller","$filter","userService",function(e,n,a,i,t,r,o,l,c){"use strict";o("BaseApiController",{$scope:n});var u=l("translate");if(!n.requireRole("ROLE_ADMIN"))return e.$emit("log.error",{timeout:5e3,cause:403,msg:u("common.error.forbidden")}),void r.path("/");n.getEntities("campaign").then(function(e){n.campaigns=e},function(e){console.error(e)})}]),angular.module("itkCampaignApp").controller("ItkCampaignController",["busService","$scope","$timeout","ModalService","$routeParams","$location","$controller","$filter","userService",function(e,n,a,i,t,r,o,l,c){"use strict";o("BaseApiController",{$scope:n});var u=l("translate");if(!n.requireRole("ROLE_ADMIN"))return e.$emit("log.error",{timeout:5e3,cause:403,msg:u("common.error.forbidden")}),void r.path("/");var p=t.id;n.campaign=null,p?n.getEntity("campaign",p).then(function(e){n.campaign=e},function(e){}):n.campaign={title:"",description:"",schedule_from:null,schedule_to:null,channels:[],screens:[],groups:[]},n.addChannels=function(){e.$emit("bodyService.addClass","is-locked"),i.showModal({templateUrl:"bundles/itkcampaign/apps/itkCampaignApp/campaign/itkCampaignModalAddChannel.html",controller:"ItkCampaignModalAddChannel",inputs:{channels:n.campaign.channels}}).then(function(n){n.close.then(function(){e.$emit("bodyService.removeClass","is-locked")})})},n.removeChannel=function(e){-1!==n.campaign.channels.indexOf(e)&&n.campaign.channels.splice(e,1)},n.addScreens=function(){e.$emit("bodyService.addClass","is-locked"),i.showModal({templateUrl:"bundles/itkcampaign/apps/itkCampaignApp/campaign/itkCampaignModalAddScreen.html",controller:"ItkCampaignModalAddScreen",inputs:{screens:n.campaign.screens}}).then(function(n){n.close.then(function(){e.$emit("bodyService.removeClass","is-locked")})})}}]),angular.module("itkCampaignApp").controller("ItkCampaignModalAddChannel",["busService","$scope","$timeout","close","channels",function(e,n,a,i,t){"use strict";n.channels=t,n.$on("channelOverview.clickChannel",function(e,n){var i;i=n,a(function(){var e=null;t.forEach(function(n,a){i.id===n.id&&(e=a)}),null!==e?t.splice(e,1):t.push(i)})}),n.closeModal=function(){i(null)}}]),angular.module("itkCampaignApp").controller("ItkCampaignModalAddScreen",["busService","$scope","$timeout","close","screens",function(e,n,a,i,t){"use strict";n.screens=t,n.$on("screenOverview.clickScreen",function(e,n){var i;i=n,a(function(){var e=null;t.forEach(function(n,a){i.id===n.id&&(e=a)}),null!==e?t.splice(e,1):t.push(i)})}),n.closeModal=function(){i(null)}}]);